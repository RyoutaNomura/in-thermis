<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="search-service">

<template>
  <iron-ajax
    id="search-service"
    auto=true
    url="/search"
    params=[[params]]
    handle-as="json"
    on-response="responseHandler"
    debounce-duration="300">
  </iron-ajax>
</template>

<style>
  :host {
    display: none;
  }
</style>

<script>
	Polymer({
		is : 'search-service',
		properties: {
			queryString: String,
			searchOrderType: String,
			params: {
				type: Object,
				notify: true,
				computed: "createParam(queryString, searchOrderType)"
			},
			results: {
				type: Array,
				notify: true
			},
			resultCount: {
				type: Number,
				value: 0,
				notify: true
			},
			ellapsedTime: {
				type: String,
				value: "0.01",
				notify: true,
			}
		},
		createParam: function(queryString, searchOrderType) {
			return {"text": queryString, "order": searchOrderType};
		},
		responseHandler : function(e, detail) {
			if (this.$['search-service'].lastResponse) {
				this.results = this.$['search-service'].lastResponse.slice(0);
				this.resultCount = this.results.length;
			} else {
				this.results = [];
				this.resultCount = 0;
			}
		}
	});
</script>

</dom-module>